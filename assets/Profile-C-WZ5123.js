import{k as pe,c as Q,i as x,a as u,D as ae,C as dt,l as oe,r as we,q as $e,p as V,L as ne,$ as Ye,n as ft,d as G,e as se,w as f,h as pt,z as be,y as ue,j as W,b as h,t as H,X as Ee,o as xe,a6 as ht,s as Je,g as et,A as Ie,F as tt,Z as gt,G as Se,a7 as mt,I as ot,J as nt,u as ee,N as ie,a8 as vt,O as te,f as bt}from"./index-DyArWEBF.js";import{u as yt}from"./localTokenManager-C58B28bb.js";import{u as kt}from"./gameRoles-CXZHzz5b.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as wt}from"./EllipsisHorizontal-i7TfOBf4.js";import{R as Ne}from"./Refresh-Da3U7XaG.js";import{C as jt}from"./CloudUpload-D33L_pSL.js";import{C as rt,S as Ct,T as St,a as Tt}from"./index-Cu-38CWq.js";import{u as _t}from"./auth-hkSCTkBd.js";import{_ as ge,g as me,H as Ot,N as Fe,n as He,y as $t,q as Et,i as Le,R as Lt,u as Vt,O as Ge,s as Mt,a as xt,B as Ft}from"./index-CGiVfv3v.js";import{T as Pt,C as Wt,R as qt,I as At}from"./index-Cgh3KRmE.js";import{g as Be,s as Ke}from"./get-value-by-path-CWBkdf6J.js";const Ut={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Rt=u("rect",{x:"128",y:"128",width:"336",height:"336",rx:"57",ry:"57",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),zt=u("path",{d:"M383.5 128l.5-24a56.16 56.16 0 0 0-56-56H112a64.19 64.19 0 0 0-64 64v216a56.16 56.16 0 0 0 56 56h24",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),It=[Rt,zt],Nt=pe({name:"CopyOutline",render:function(t,n){return x(),Q("svg",Ut,It)}});function Ze(e){return typeof e=="object"&&e!=null&&e.nodeType===1}function De(e,t){return(!t||e!=="hidden")&&e!=="visible"&&e!=="clip"}function Te(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var n=getComputedStyle(e,null);return De(n.overflowY,t)||De(n.overflowX,t)||function(o){var s=function(l){if(!l.ownerDocument||!l.ownerDocument.defaultView)return null;try{return l.ownerDocument.defaultView.frameElement}catch{return null}}(o);return!!s&&(s.clientHeight<o.scrollHeight||s.clientWidth<o.scrollWidth)}(e)}return!1}function ve(e,t,n,o,s,l,c,p){return l<e&&c>t||l>e&&c<t?0:l<=e&&p<=n||c>=t&&p>=n?l-e-o:c>t&&p<n||l<e&&p>n?c-t+s:0}var Qe=function(e,t){var n=window,o=t.scrollMode,s=t.block,l=t.inline,c=t.boundary,p=t.skipOverflowHiddenElements,$=typeof c=="function"?c:function(ct){return ct!==c};if(!Ze(e))throw new TypeError("Invalid target");for(var E,z,K=document.scrollingElement||document.documentElement,S=[],O=e;Ze(O)&&$(O);){if((O=(z=(E=O).parentElement)==null?E.getRootNode().host||null:z)===K){S.push(O);break}O!=null&&O===document.body&&Te(O)&&!Te(document.documentElement)||O!=null&&Te(O,p)&&S.push(O)}for(var U=n.visualViewport?n.visualViewport.width:innerWidth,q=n.visualViewport?n.visualViewport.height:innerHeight,M=window.scrollX||pageXOffset,g=window.scrollY||pageYOffset,r=e.getBoundingClientRect(),T=r.height,_=r.width,I=r.top,Z=r.right,N=r.bottom,d=r.left,i=s==="start"||s==="nearest"?I:s==="end"?N:I+T/2,m=l==="center"?d+_/2:l==="end"?Z:d,w=[],b=0;b<S.length;b++){var j=S[b],A=j.getBoundingClientRect(),F=A.height,P=A.width,Y=A.top,y=A.right,C=A.bottom,a=A.left;if(o==="if-needed"&&I>=0&&d>=0&&N<=q&&Z<=U&&I>=Y&&N<=C&&d>=a&&Z<=y)return w;var v=getComputedStyle(j),k=parseInt(v.borderLeftWidth,10),L=parseInt(v.borderTopWidth,10),D=parseInt(v.borderRightWidth,10),B=parseInt(v.borderBottomWidth,10),R=0,J=0,ce="offsetWidth"in j?j.offsetWidth-j.clientWidth-k-D:0,fe="offsetHeight"in j?j.offsetHeight-j.clientHeight-L-B:0,Ae="offsetWidth"in j?j.offsetWidth===0?0:P/j.offsetWidth:0,Ue="offsetHeight"in j?j.offsetHeight===0?0:F/j.offsetHeight:0;if(K===j)R=s==="start"?i:s==="end"?i-q:s==="nearest"?ve(g,g+q,q,L,B,g+i,g+i+T,T):i-q/2,J=l==="start"?m:l==="center"?m-U/2:l==="end"?m-U:ve(M,M+U,U,k,D,M+m,M+m+_,_),R=Math.max(0,R+g),J=Math.max(0,J+M);else{R=s==="start"?i-Y-L:s==="end"?i-C+B+fe:s==="nearest"?ve(Y,C,F,L,B+fe,i,i+T,T):i-(Y+F/2)+fe/2,J=l==="start"?m-a-k:l==="center"?m-(a+P/2)+ce/2:l==="end"?m-y+D+ce:ve(a,y,P,k,D+ce,m,m+_,_);var Re=j.scrollLeft,ze=j.scrollTop;i+=ze-(R=Math.max(0,Math.min(ze+R/Ue,j.scrollHeight-F/Ue+fe))),m+=Re-(J=Math.max(0,Math.min(Re+J/Ae,j.scrollWidth-P/Ae+ce)))}w.push({el:j,top:R,left:J})}return w};function it(e){return e===Object(e)&&Object.keys(e).length!==0}function Ht(e,t){t===void 0&&(t="auto");var n="scrollBehavior"in document.body.style;e.forEach(function(o){var s=o.el,l=o.top,c=o.left;s.scroll&&n?s.scroll({top:l,left:c,behavior:t}):(s.scrollTop=l,s.scrollLeft=c)})}function Gt(e){return e===!1?{block:"end",inline:"nearest"}:it(e)?e:{block:"start",inline:"nearest"}}function Bt(e,t){var n=e.isConnected||e.ownerDocument.documentElement.contains(e);if(it(t)&&typeof t.behavior=="function")return t.behavior(n?Qe(e,t):[]);if(n){var o=Gt(t);return Ht(Qe(e,o),o.behavior)}}const Xe=["success","warning","error","validating"],Kt=e=>{let t="";for(const n of Object.keys(e)){const o=e[n];o&&(!t||Xe.indexOf(o)>Xe.indexOf(t))&&(t=e[n])}return t},Zt=e=>{const t=[];for(const n of Object.keys(e)){const o=e[n];o&&t.push(o)}return t},lt=(e,t)=>{const n=t.replace(/[[.]/g,"_").replace(/\]/g,"");return e?`${e}-${n}`:`${n}`},Dt=pe({name:"Form",props:{model:{type:Object,required:!0},layout:{type:String,default:"horizontal"},size:{type:String},labelColProps:{type:Object,default:()=>({span:5,offset:0})},wrapperColProps:{type:Object,default:()=>({span:19,offset:0})},labelColStyle:Object,wrapperColStyle:Object,labelAlign:{type:String,default:"right"},disabled:{type:Boolean,default:void 0},rules:{type:Object},autoLabelWidth:{type:Boolean,default:!1},id:{type:String},scrollToFirstError:{type:Boolean,default:!1}},emits:{submit:(e,t)=>!0,submitSuccess:(e,t)=>!0,submitFailed:(e,t)=>!0},setup(e,{emit:t}){const n=me("form"),o=we(),{id:s,model:l,layout:c,disabled:p,labelAlign:$,labelColProps:E,wrapperColProps:z,labelColStyle:K,wrapperColStyle:S,size:O,rules:U}=$e(e),{mergedSize:q}=Ot(O),M=V(()=>e.layout==="horizontal"&&e.autoLabelWidth),g=[],r=[],T=ne({}),_=V(()=>Math.max(...Object.values(T))),I=y=>{y&&y.field&&g.push(y)},Z=y=>{y&&y.field&&g.splice(g.indexOf(y),1)},N=y=>{g.forEach(C=>{y[C.field]&&C.setField(y[C.field])})},d=(y,C)=>{C&&T[C]!==y&&(T[C]=y)},i=y=>{y&&delete T[y]},m=y=>{const C=y?[].concat(y):[];g.forEach(a=>{(C.length===0||C.includes(a.field))&&a.resetField()})},w=y=>{const C=y?[].concat(y):[];g.forEach(a=>{(C.length===0||C.includes(a.field))&&a.clearValidate()})},b=(y,C)=>{const v=(o.value||document.body).querySelector(`#${lt(e.id,y)}`);v&&Bt(v,{behavior:"smooth",block:"nearest",scrollMode:"if-needed",...C})},j=y=>{const C=Et(e.scrollToFirstError)?void 0:e.scrollToFirstError;b(y,C)},A=y=>{const C=[];return g.forEach(a=>{C.push(a.validate())}),Promise.all(C).then(a=>{const v={};let k=!1;return a.forEach(L=>{L&&(k=!0,v[L.field]=L)}),k&&e.scrollToFirstError&&j(Object.keys(v)[0]),He(y)&&y(k?v:void 0),k?v:void 0})},F=(y,C)=>{const a=[];for(const v of g)($t(y)&&y.includes(v.field)||y===v.field)&&a.push(v.validate());return Promise.all(a).then(v=>{const k={};let L=!1;return v.forEach(D=>{D&&(L=!0,k[D.field]=D)}),L&&e.scrollToFirstError&&j(Object.keys(k)[0]),He(C)&&C(L?k:void 0),L?k:void 0})},P=y=>{const C=[];g.forEach(a=>{C.push(a.validate())}),Promise.all(C).then(a=>{const v={};let k=!1;a.forEach(L=>{L&&(k=!0,v[L.field]=L)}),k?(e.scrollToFirstError&&j(Object.keys(v)[0]),t("submitFailed",{values:l.value,errors:v},y)):t("submitSuccess",l.value,y),t("submit",{values:l.value,errors:k?v:void 0},y)})};return Ye(Fe,ne({id:s,layout:c,disabled:p,labelAlign:$,labelColProps:E,wrapperColProps:z,labelColStyle:K,wrapperColStyle:S,model:l,size:q,rules:U,fields:g,touchedFields:r,addField:I,removeField:Z,validateField:F,setLabelWidth:d,removeLabelWidth:i,maxLabelWidth:_,autoLabelWidth:M})),{cls:V(()=>[n,`${n}-layout-${e.layout}`,`${n}-size-${q.value}`,{[`${n}-auto-label-width`]:e.autoLabelWidth}]),formRef:o,handleSubmit:P,innerValidate:A,innerValidateField:F,innerResetFields:m,innerClearValidate:w,innerSetFields:N,innerScrollToField:b}},methods:{validate(e){return this.innerValidate(e)},validateField(e,t){return this.innerValidateField(e,t)},resetFields(e){return this.innerResetFields(e)},clearValidate(e){return this.innerClearValidate(e)},setFields(e){return this.innerSetFields(e)},scrollToField(e){return this.innerScrollToField(e)}}}),Qt=["id"];function Xt(e,t,n,o,s,l){return x(),Q("form",{id:e.id,ref:"formRef",class:oe(e.cls),onSubmit:t[0]||(t[0]=dt((...c)=>e.handleSubmit&&e.handleSubmit(...c),["prevent"]))},[ae(e.$slots,"default")],42,Qt)}var _e=ge(Dt,[["render",Xt]]),he=Object.prototype.toString;function je(e){return he.call(e)==="[object Array]"}function re(e){return he.call(e)==="[object Object]"}function Ve(e){return he.call(e)==="[object String]"}function Yt(e){return he.call(e)==="[object Number]"&&e===e}function Jt(e){return he.call(e)==="[object Boolean]"}function Me(e){return he.call(e)==="[object Function]"}function eo(e){return re(e)&&Object.keys(e).length===0}function de(e){return e==null||e===""}function at(e){return je(e)&&!e.length}var Pe=function(e,t){if(typeof e!="object"||typeof t!="object")return e===t;if(Me(e)&&Me(t))return e===t||e.toString()===t.toString();if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e){var o=Pe(e[n],t[n]);if(!o)return!1}return!0},We=function(e,t){var n=Object.assign({},e);return Object.keys(t||{}).forEach(function(o){var s=n[o],l=t==null?void 0:t[o];n[o]=re(s)?Object.assign(Object.assign({},s),l):l||s}),n},to=function(e,t){for(var n=t.split("."),o=e,s=0;s<n.length;s++)if(o=o&&o[n[s]],o===void 0)return o;return o},le="#{field} is not a #{type} type",oo={required:"#{field} is required",type:{ip:le,email:le,url:le,string:le,number:le,array:le,object:le,boolean:le},number:{min:"`#{value}` is not greater than `#{min}`",max:"`#{value}` is not less than `#{max}`",equal:"`#{value}` is not equal to `#{equal}`",range:"`#{value}` is not in range `#{min} ~ #{max}`",positive:"`#{value}` is not a positive number",negative:"`#{value}` is not a negative number"},string:{maxLength:"#{field} cannot be longer than #{maxLength} characters",minLength:"#{field} must be at least #{minLength} characters",length:"#{field} must be exactly #{length} characters",match:"`#{value}` does not match pattern #{pattern}",uppercase:"`#{value}` must be all uppercase",lowercase:"`#{value}` must be all lowercased"},array:{length:"#{field} must be exactly #{length} in length",minLength:"#{field} cannot be less than #{minLength} in length",maxLength:"#{field} cannot be greater than #{maxLength} in length",includes:"#{field} is not includes #{includes}",deepEqual:"#{field} is not deep equal with #{deepEqual}",empty:"#{field} is not an empty array"},object:{deepEqual:"#{field} is not deep equal to expected value",hasKeys:"#{field} does not contain required fields",empty:"#{field} is not an empty object"},boolean:{true:"Expect true but got `#{value}`",false:"Expect false but got `#{value}`"}},X=function(t,n){var o=this;this.getValidateMsg=function(s,l){l===void 0&&(l={});var c=Object.assign(Object.assign({},l),{value:o.obj,field:o.field,type:o.type}),p=to(o.validateMessages,s);return Me(p)?p(c):Ve(p)?p.replace(/\#\{.+?\}/g,function($){var E=$.slice(2,-1);if(E in c){if(re(c[E])||je(c[E]))try{return JSON.stringify(c[E])}catch{return c[E]}return String(c[E])}return $}):p},re(n)&&Ve(t)&&n.trim?this.obj=t.trim():re(n)&&n.ignoreEmptyString&&t===""?this.obj=void 0:this.obj=t,this.message=n.message,this.type=n.type,this.error=null,this.field=n.field||n.type,this.validateMessages=We(oo,n.validateMessages)},Ce={not:{configurable:!0},isRequired:{configurable:!0},end:{configurable:!0}};Ce.not.get=function(){return this._not=!this._not,this};Ce.isRequired.get=function(){if(de(this.obj)||at(this.obj)){var e=this.getValidateMsg("required");this.error={value:this.obj,type:this.type,requiredError:!0,message:this.message||(re(e)?e:(this._not?"[NOT MODE]:":"")+e)}}return this};Ce.end.get=function(){return this.error};X.prototype.addError=function(t){!this.error&&t&&(this.error={value:this.obj,type:this.type,message:this.message||(re(t)?t:(this._not?"[NOT MODE]:":"")+t)})};X.prototype.validate=function(t,n){var o=this._not?t:!t;return o&&this.addError(n),this};X.prototype.collect=function(t){t&&t(this.error)};Object.defineProperties(X.prototype,Ce);var no=function(e){function t(o,s){e.call(this,o,Object.assign(Object.assign({},s),{type:"string"})),this.validate(s&&s.strict?Ve(this.obj):!0,this.getValidateMsg("type.string"))}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={uppercase:{configurable:!0},lowercase:{configurable:!0}};return t.prototype.maxLength=function(s){return this.obj?this.validate(this.obj.length<=s,this.getValidateMsg("string.maxLength",{maxLength:s})):this},t.prototype.minLength=function(s){return this.obj?this.validate(this.obj.length>=s,this.getValidateMsg("string.minLength",{minLength:s})):this},t.prototype.length=function(s){return this.obj?this.validate(this.obj.length===s,this.getValidateMsg("string.length",{length:s})):this},t.prototype.match=function(s){var l=s instanceof RegExp;return l&&(s.lastIndex=0),this.validate(this.obj===void 0||l&&s.test(this.obj),this.getValidateMsg("string.match",{pattern:s}))},n.uppercase.get=function(){return this.obj?this.validate(this.obj.toUpperCase()===this.obj,this.getValidateMsg("string.uppercase")):this},n.lowercase.get=function(){return this.obj?this.validate(this.obj.toLowerCase()===this.obj,this.getValidateMsg("string.lowercase")):this},Object.defineProperties(t.prototype,n),t}(X),so=function(e){function t(o,s){e.call(this,o,Object.assign(Object.assign({},s),{type:"number"})),this.validate(s&&s.strict?Yt(this.obj):!0,this.getValidateMsg("type.number"))}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={positive:{configurable:!0},negative:{configurable:!0}};return t.prototype.min=function(s){return de(this.obj)?this:this.validate(this.obj>=s,this.getValidateMsg("number.min",{min:s}))},t.prototype.max=function(s){return de(this.obj)?this:this.validate(this.obj<=s,this.getValidateMsg("number.max",{max:s}))},t.prototype.equal=function(s){return de(this.obj)?this:this.validate(this.obj===s,this.getValidateMsg("number.equal",{equal:s}))},t.prototype.range=function(s,l){return de(this.obj)?this:this.validate(this.obj>=s&&this.obj<=l,this.getValidateMsg("number.range",{min:s,max:l}))},n.positive.get=function(){return de(this.obj)?this:this.validate(this.obj>0,this.getValidateMsg("number.positive"))},n.negative.get=function(){return de(this.obj)?this:this.validate(this.obj<0,this.getValidateMsg("number.negative"))},Object.defineProperties(t.prototype,n),t}(X),ro=function(e){function t(o,s){e.call(this,o,Object.assign(Object.assign({},s),{type:"array"})),this.validate(s&&s.strict?je(this.obj):!0,this.getValidateMsg("type.array",{value:this.obj,type:this.type}))}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={empty:{configurable:!0}};return t.prototype.length=function(s){return this.obj?this.validate(this.obj.length===s,this.getValidateMsg("array.length",{value:this.obj,length:s})):this},t.prototype.minLength=function(s){return this.obj?this.validate(this.obj.length>=s,this.getValidateMsg("array.minLength",{value:this.obj,minLength:s})):this},t.prototype.maxLength=function(s){return this.obj?this.validate(this.obj.length<=s,this.getValidateMsg("array.maxLength",{value:this.obj,maxLength:s})):this},t.prototype.includes=function(s){var l=this;return this.obj?this.validate(s.every(function(c){return l.obj.indexOf(c)!==-1}),this.getValidateMsg("array.includes",{value:this.obj,includes:s})):this},t.prototype.deepEqual=function(s){return this.obj?this.validate(Pe(this.obj,s),this.getValidateMsg("array.deepEqual",{value:this.obj,deepEqual:s})):this},n.empty.get=function(){return this.validate(at(this.obj),this.getValidateMsg("array.empty",{value:this.obj}))},Object.defineProperties(t.prototype,n),t}(X),io=function(e){function t(o,s){e.call(this,o,Object.assign(Object.assign({},s),{type:"object"})),this.validate(s&&s.strict?re(this.obj):!0,this.getValidateMsg("type.object"))}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={empty:{configurable:!0}};return t.prototype.deepEqual=function(s){return this.obj?this.validate(Pe(this.obj,s),this.getValidateMsg("object.deepEqual",{deepEqual:s})):this},t.prototype.hasKeys=function(s){var l=this;return this.obj?this.validate(s.every(function(c){return l.obj[c]}),this.getValidateMsg("object.hasKeys",{keys:s})):this},n.empty.get=function(){return this.validate(eo(this.obj),this.getValidateMsg("object.empty"))},Object.defineProperties(t.prototype,n),t}(X),lo=function(e){function t(o,s){e.call(this,o,Object.assign(Object.assign({},s),{type:"boolean"})),this.validate(s&&s.strict?Jt(this.obj):!0,this.getValidateMsg("type.boolean"))}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={true:{configurable:!0},false:{configurable:!0}};return n.true.get=function(){return this.validate(this.obj===!0,this.getValidateMsg("boolean.true"))},n.false.get=function(){return this.validate(this.obj===!1,this.getValidateMsg("boolean.false"))},Object.defineProperties(t.prototype,n),t}(X),ao=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,uo=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),co=/^(2(5[0-5]{1}|[0-4]\d{1})|[0-1]?\d{1,2})(\.(2(5[0-5]{1}|[0-4]\d{1})|[0-1]?\d{1,2})){3}$/,fo=function(e){function t(o,s){e.call(this,o,Object.assign(Object.assign({},s),{type:"type"}))}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={email:{configurable:!0},url:{configurable:!0},ip:{configurable:!0}};return n.email.get=function(){return this.type="email",this.validate(this.obj===void 0||ao.test(this.obj),this.getValidateMsg("type.email"))},n.url.get=function(){return this.type="url",this.validate(this.obj===void 0||uo.test(this.obj),this.getValidateMsg("type.url"))},n.ip.get=function(){return this.type="ip",this.validate(this.obj===void 0||co.test(this.obj),this.getValidateMsg("type.ip"))},Object.defineProperties(t.prototype,n),t}(X),po=function(e){function t(o,s){e.call(this,o,Object.assign(Object.assign({},s),{type:"custom"}))}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={validate:{configurable:!0}};return n.validate.get=function(){var o=this;return function(s,l){var c;if(s)return c=s(o.obj,o.addError.bind(o)),c&&c.then?(l&&c.then(function(){l&&l(o.error)},function(p){console.error(p)}),[c,o]):(l&&l(o.error),o.error)}},Object.defineProperties(t.prototype,n),t}(X),ke=function(e,t){return new ut(e,Object.assign({field:"value"},t))};ke.globalConfig={};ke.setGlobalConfig=function(e){ke.globalConfig=e||{}};var ut=function(t,n){var o=ke.globalConfig,s=Object.assign(Object.assign(Object.assign({},o),n),{validateMessages:We(o.validateMessages,n.validateMessages)});this.string=new no(t,s),this.number=new so(t,s),this.array=new ro(t,s),this.object=new io(t,s),this.boolean=new lo(t,s),this.type=new fo(t,s),this.custom=new po(t,s)},qe=function(t,n){n===void 0&&(n={}),this.schema=t,this.options=n};qe.prototype.messages=function(t){this.options=Object.assign(Object.assign({},this.options),{validateMessages:We(this.options.validateMessages,t)})};qe.prototype.validate=function(t,n){var o=this;if(!re(t))return;var s=[],l=null;function c(p,$){l||(l={}),(!l[p]||$.requiredError)&&(l[p]=$)}this.schema&&Object.keys(this.schema).forEach(function(p){if(je(o.schema[p]))for(var $=function(K){var S=o.schema[p][K],O=S.type,U=S.message;if(!O&&!S.validator)throw"You must specify a type to field "+p+"!";var q=Object.assign(Object.assign({},o.options),{message:U,field:p});"ignoreEmptyString"in S&&(q.ignoreEmptyString=S.ignoreEmptyString),"strict"in S&&(q.strict=S.strict);var M=new ut(t[p],q),g=M.type[O]||null;if(!g)if(S.validator){g=M.custom.validate(S.validator),Object.prototype.toString.call(g)==="[object Array]"&&g[0].then?s.push({function:g[0],_this:g[1],key:p}):g&&c(p,g);return}else g=M[O];if(Object.keys(S).forEach(function(r){S.required&&(g=g.isRequired),r!=="message"&&g[r]&&S[r]&&typeof g[r]=="object"&&(g=g[r]),g[r]&&S[r]!==void 0&&typeof g[r]=="function"&&(g=g[r](S[r]))}),g.collect(function(r){r&&c(p,r)}),l)return"break"},E=0;E<o.schema[p].length;E++){var z=$(E);if(z==="break")break}}),s.length>0?Promise.all(s.map(function(p){return p.function})).then(function(){s.forEach(function(p){p._this.error&&c(p.key,p._this.error)}),n&&n(l)}):n&&n(l)};const ho=pe({name:"IconQuestionCircle",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:t}){const n=me("icon"),o=V(()=>[n,`${n}-question-circle`,{[`${n}-spin`]:e.spin}]),s=V(()=>{const c={};return e.size&&(c.fontSize=Le(e.size)?`${e.size}px`:e.size),e.rotate&&(c.transform=`rotate(${e.rotate}deg)`),c});return{cls:o,innerStyle:s,onClick:c=>{t("click",c)}}}}),go=["stroke-width","stroke-linecap","stroke-linejoin"];function mo(e,t,n,o,s,l){return x(),Q("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:oe(e.cls),style:ft(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:t[0]||(t[0]=(...c)=>e.onClick&&e.onClick(...c))},t[1]||(t[1]=[u("path",{d:"M42 24c0 9.941-8.059 18-18 18S6 33.941 6 24 14.059 6 24 6s18 8.059 18 18Z"},null,-1),u("path",{d:"M24.006 31v4.008m0-6.008L24 28c0-3 3-4 4.78-6.402C30.558 19.195 28.288 15 23.987 15c-4.014 0-5.382 2.548-5.388 4.514v.465"},null,-1)]),14,go)}var Oe=ge(ho,[["render",mo]]);const vo=Object.assign(Oe,{install:(e,t)=>{var n;const o=(n=t==null?void 0:t.iconPrefix)!=null?n:"";e.component(o+Oe.name,Oe)}}),bo=pe({name:"FormItemLabel",components:{ResizeObserver:Lt,Tooltip:Pt,IconQuestionCircle:vo},props:{required:{type:Boolean,default:!1},showColon:{type:Boolean,default:!1},component:{type:String,default:"label"},asteriskPosition:{type:String,default:"start"},tooltip:{type:String},attrs:Object},setup(){const e=me("form-item-label"),t=Ee(Fe,void 0),n=ht(),o=we(),s=()=>{o.value&&Le(o.value.offsetWidth)&&(t==null||t.setLabelWidth(o.value.offsetWidth,n==null?void 0:n.uid))};return xe(()=>{o.value&&Le(o.value.offsetWidth)&&(t==null||t.setLabelWidth(o.value.offsetWidth,n==null?void 0:n.uid))}),Je(()=>{t==null||t.removeLabelWidth(n==null?void 0:n.uid)}),{prefixCls:e,labelRef:o,handleResize:s}}});function yo(e,t,n,o,s,l){const c=G("icon-question-circle"),p=G("Tooltip"),$=G("ResizeObserver");return x(),se($,{onResize:e.handleResize},{default:f(()=>[(x(),se(pt(e.component),be({ref:"labelRef",class:e.prefixCls},e.attrs),{default:f(()=>[e.required&&e.asteriskPosition==="start"?(x(),Q("strong",{key:0,class:oe(`${e.prefixCls}-required-symbol`)},t[0]||(t[0]=[u("svg",{fill:"currentColor",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},[u("path",{d:"M583.338667 17.066667c18.773333 0 34.133333 15.36 34.133333 34.133333v349.013333l313.344-101.888a34.133333 34.133333 0 0 1 43.008 22.016l42.154667 129.706667a34.133333 34.133333 0 0 1-21.845334 43.178667l-315.733333 102.4 208.896 287.744a34.133333 34.133333 0 0 1-7.509333 47.786666l-110.421334 80.213334a34.133333 34.133333 0 0 1-47.786666-7.509334L505.685333 706.218667 288.426667 1005.226667a34.133333 34.133333 0 0 1-47.786667 7.509333l-110.421333-80.213333a34.133333 34.133333 0 0 1-7.509334-47.786667l214.186667-295.253333L29.013333 489.813333a34.133333 34.133333 0 0 1-22.016-43.008l42.154667-129.877333a34.133333 34.133333 0 0 1 43.008-22.016l320.512 104.106667L412.672 51.2c0-18.773333 15.36-34.133333 34.133333-34.133333h136.533334z"})],-1)]),2)):ue("v-if",!0),ae(e.$slots,"default"),e.tooltip?(x(),se(p,{key:1,content:e.tooltip},{default:f(()=>[h(c,{class:oe(`${e.prefixCls}-tooltip`)},null,8,["class"])]),_:1},8,["content"])):ue("v-if",!0),e.required&&e.asteriskPosition==="end"?(x(),Q("strong",{key:2,class:oe(`${e.prefixCls}-required-symbol`)},t[1]||(t[1]=[u("svg",{fill:"currentColor",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},[u("path",{d:"M583.338667 17.066667c18.773333 0 34.133333 15.36 34.133333 34.133333v349.013333l313.344-101.888a34.133333 34.133333 0 0 1 43.008 22.016l42.154667 129.706667a34.133333 34.133333 0 0 1-21.845334 43.178667l-315.733333 102.4 208.896 287.744a34.133333 34.133333 0 0 1-7.509333 47.786666l-110.421334 80.213334a34.133333 34.133333 0 0 1-47.786666-7.509334L505.685333 706.218667 288.426667 1005.226667a34.133333 34.133333 0 0 1-47.786667 7.509333l-110.421333-80.213333a34.133333 34.133333 0 0 1-7.509334-47.786667l214.186667-295.253333L29.013333 489.813333a34.133333 34.133333 0 0 1-22.016-43.008l42.154667-129.877333a34.133333 34.133333 0 0 1 43.008-22.016l320.512 104.106667L412.672 51.2c0-18.773333 15.36-34.133333 34.133333-34.133333h136.533334z"})],-1)]),2)):ue("v-if",!0),W(" "+H(e.showColon?":":""),1)]),_:3},16,["class"]))]),_:3},8,["onResize"])}var ko=ge(bo,[["render",yo]]);const wo=pe({name:"FormItemMessage",props:{error:{type:Array,default:()=>[]},help:String},setup(){return{prefixCls:me("form-item-message")}}});function jo(e,t,n,o,s,l){return e.error.length>0?(x(!0),Q(tt,{key:0},et(e.error,c=>(x(),se(Ie,{key:c,name:"form-blink",appear:""},{default:f(()=>[u("div",{role:"alert",class:oe([e.prefixCls])},H(c),3)]),_:2},1024))),128)):e.help||e.$slots.help?(x(),se(Ie,{key:1,name:"form-blink",appear:""},{default:f(()=>[u("div",{class:oe([e.prefixCls,`${e.prefixCls}-help`])},[ae(e.$slots,"help",{},()=>[W(H(e.help),1)])],2)]),_:3})):ue("v-if",!0)}var Co=ge(wo,[["render",jo]]);const So=pe({name:"FormItem",components:{ArcoRow:qt,ArcoCol:Wt,FormItemLabel:ko,FormItemMessage:Co},props:{field:{type:String,default:""},label:String,tooltip:{type:String},showColon:{type:Boolean,default:!1},noStyle:{type:Boolean,default:!1},disabled:{type:Boolean,default:void 0},help:String,extra:String,required:{type:Boolean,default:!1},asteriskPosition:{type:String,default:"start"},rules:{type:[Object,Array]},validateStatus:{type:String},validateTrigger:{type:[String,Array],default:"change"},labelColProps:Object,wrapperColProps:Object,hideLabel:{type:Boolean,default:!1},hideAsterisk:{type:Boolean,default:!1},labelColStyle:Object,wrapperColStyle:Object,rowProps:Object,rowClass:[String,Array,Object],contentClass:[String,Array,Object],contentFlex:{type:Boolean,default:!0},mergeProps:{type:[Boolean,Function],default:!0},labelColFlex:{type:[Number,String]},feedback:{type:Boolean,default:!1},labelComponent:{type:String,default:"label"},labelAttrs:Object},setup(e){const t=me("form-item"),{field:n}=$e(e),o=Ee(Fe,{}),{autoLabelWidth:s,layout:l}=$e(o),{i18nMessage:c}=Vt(),p=V(()=>{var a;const v={...(a=e.labelColProps)!=null?a:o.labelColProps};return e.labelColFlex?v.flex=e.labelColFlex:o.autoLabelWidth&&(v.flex=`${o.maxLabelWidth}px`),v}),$=V(()=>{var a;const v={...(a=e.wrapperColProps)!=null?a:o.wrapperColProps};return n.value&&(v.id=lt(o.id,n.value)),(e.labelColFlex||o.autoLabelWidth)&&(v.flex="auto"),v}),E=V(()=>{var a;return(a=e.labelColStyle)!=null?a:o.labelColStyle}),z=V(()=>{var a;return(a=e.wrapperColStyle)!=null?a:o.wrapperColStyle}),K=Be(o.model,e.field),S=ne({}),O=ne({}),U=V(()=>Kt(S)),q=V(()=>Zt(O)),M=we(!1),g=V(()=>Be(o.model,e.field)),r=V(()=>{var a;return!!((a=e.disabled)!=null?a:o!=null&&o.disabled)}),T=V(()=>{var a;return(a=e.validateStatus)!=null?a:U.value}),_=V(()=>T.value==="error"),I=V(()=>{var a,v,k;const L=[].concat((k=(v=e.rules)!=null?v:(a=o==null?void 0:o.rules)==null?void 0:a[e.field])!=null?k:[]),D=L.some(B=>B.required);return e.required&&!D?[{required:!0}].concat(L):L}),Z=V(()=>I.value.some(a=>a.required)),N=e.noStyle?Ee(Ge,void 0):void 0,d=(a,{status:v,message:k})=>{S[a]=v,O[a]=k,e.noStyle&&(N==null||N.updateValidateState(a,{status:v,message:k}))},i=V(()=>e.feedback&&T.value?T.value:void 0),m=()=>{var a;if(M.value)return Promise.resolve();const v=I.value;if(!n.value||v.length===0)return U.value&&j(),Promise.resolve();const k=n.value,L=g.value;d(k,{status:"",message:""});const D=new qe({[k]:v.map(({...B})=>(!B.type&&!B.validator&&(B.type="string"),B))},{ignoreEmptyString:!0,validateMessages:(a=c.value.form)==null?void 0:a.validateMessages});return new Promise(B=>{D.validate({[k]:L},R=>{var J;const ce=!!(R!=null&&R[k]);d(k,{status:ce?"error":"",message:(J=R==null?void 0:R[k].message)!=null?J:""});const fe=ce?{label:e.label,field:n.value,value:R[k].value,type:R[k].type,isRequiredError:!!R[k].requiredError,message:R[k].message}:void 0;B(fe)})})},w=V(()=>[].concat(e.validateTrigger)),b=V(()=>w.value.reduce((a,v)=>{switch(v){case"change":return a.onChange=()=>{m()},a;case"input":return a.onInput=()=>{Se(()=>{m()})},a;case"focus":return a.onFocus=()=>{m()},a;case"blur":return a.onBlur=()=>{m()},a;default:return a}},{}));Ye(Ge,ne({eventHandlers:b,size:o&&mt(o,"size"),disabled:r,error:_,feedback:i,updateValidateState:d}));const j=()=>{n.value&&d(n.value,{status:"",message:""})},P=ne({field:n,disabled:r,error:_,validate:m,clearValidate:j,resetField:()=>{j(),M.value=!0,o!=null&&o.model&&n.value&&Ke(o.model,n.value,K),Se(()=>{M.value=!1})},setField:a=>{var v,k;n.value&&(M.value=!0,"value"in a&&(o!=null&&o.model)&&n.value&&Ke(o.model,n.value,a.value),(a.status||a.message)&&d(n.value,{status:(v=a.status)!=null?v:"",message:(k=a.message)!=null?k:""}),Se(()=>{M.value=!1}))}});xe(()=>{var a;P.field&&((a=o.addField)==null||a.call(o,P))}),Je(()=>{var a;P.field&&((a=o.removeField)==null||a.call(o,P))});const Y=V(()=>[t,`${t}-layout-${o.layout}`,{[`${t}-error`]:_.value,[`${t}-status-${T.value}`]:!!T.value},e.rowClass]),y=V(()=>[`${t}-label-col`,{[`${t}-label-col-left`]:o.labelAlign==="left",[`${t}-label-col-flex`]:o.autoLabelWidth||e.labelColFlex}]),C=V(()=>[`${t}-wrapper-col`,{[`${t}-wrapper-col-flex`]:!$.value}]);return{prefixCls:t,cls:Y,isRequired:Z,isError:_,finalMessage:q,mergedLabelCol:p,mergedWrapperCol:$,labelColCls:y,autoLabelWidth:s,layout:l,mergedLabelStyle:E,wrapperColCls:C,mergedWrapperStyle:z}}});function To(e,t,n,o,s,l){var c;const p=G("FormItemLabel"),$=G("ArcoCol"),E=G("FormItemMessage"),z=G("ArcoRow");return e.noStyle?ae(e.$slots,"default",{key:0}):(x(),se(z,be({key:1,class:[e.cls,{[`${e.prefixCls}-has-help`]:!!((c=e.$slots.help)!=null?c:e.help)}],wrap:!(e.labelColFlex||e.autoLabelWidth),div:e.layout!=="horizontal"||e.hideLabel},e.rowProps),{default:f(()=>[e.hideLabel?ue("v-if",!0):(x(),se($,be({key:0,class:e.labelColCls,style:e.mergedLabelStyle},e.mergedLabelCol),{default:f(()=>[h(p,{required:e.hideAsterisk?!1:e.isRequired,"show-colon":e.showColon,"asterisk-position":e.asteriskPosition,component:e.labelComponent,attrs:e.labelAttrs,tooltip:e.tooltip},{default:f(()=>[e.$slots.label||e.label?ae(e.$slots,"label",{key:0},()=>[W(H(e.label),1)]):ue("v-if",!0)]),_:3},8,["required","show-colon","asterisk-position","component","attrs","tooltip"])]),_:3},16,["class","style"])),h($,be({class:e.wrapperColCls,style:e.mergedWrapperStyle},e.mergedWrapperCol),{default:f(()=>[u("div",{class:oe(`${e.prefixCls}-content-wrapper`)},[u("div",{class:oe([`${e.prefixCls}-content`,{[`${e.prefixCls}-content-flex`]:e.contentFlex},e.contentClass])},[ae(e.$slots,"default")],2)],2),e.isError||e.$slots.help||e.help?(x(),se(E,{key:0,error:e.finalMessage,help:e.help},gt({_:2},[e.$slots.help?{name:"help",fn:f(()=>[ae(e.$slots,"help")]),key:"0"}:void 0]),1032,["error","help"])):ue("v-if",!0),e.$slots.extra||e.extra?(x(),Q("div",{key:1,class:oe(`${e.prefixCls}-extra`)},[ae(e.$slots,"extra",{},()=>[W(H(e.extra),1)])],2)):ue("v-if",!0)]),_:3},16,["class","style"])]),_:3},16,["class","wrap","div"]))}var ye=ge(So,[["render",To]]);const _o=Object.assign(_e,{Item:ye,install:(e,t)=>{Mt(e,t);const n=xt(t);e.component(n+_e.name,_e),e.component(n+ye.name,ye)}}),Oo={class:"header-actions"},$o={class:"token-section"},Eo={key:0,class:"token-item"},Lo={class:"token-info"},Vo={class:"token-value"},Mo={key:1,class:"empty-token"},xo={class:"token-section"},Fo={class:"game-tokens-list"},Po={class:"token-header"},Wo={class:"role-info"},qo={class:"role-name"},Ao={class:"role-server"},Uo={class:"token-actions"},Ro={class:"token-details"},zo={class:"detail-item"},Io={class:"detail-value"},No={class:"detail-item"},Ho={class:"detail-value"},Go={class:"detail-item"},Bo={class:"detail-value"},Ko={class:"detail-item"},Zo={class:"detail-value"},Do={class:"detail-item"},Qo={__name:"TokenManager",setup(e){const t=ot(),n=nt(),o=yt(),s=kt(),l=d=>{if(!d)return"";const i=d.length;return i<=8?d:d.substring(0,8)+"***"+d.substring(i-8)},c=d=>new Date(d).toLocaleString("zh-CN"),p=d=>o.getWebSocketStatus(d),$=d=>{switch(d){case"connected":return"success";case"error":return"error";case"connecting":return"warning";default:return"default"}},E=d=>{switch(d){case"connected":return"已连接";case"error":return"连接错误";case"connecting":return"连接中";default:return"未连接"}},z=d=>{const i=[{label:"编辑",key:"edit",icon:()=>te(ie,null,{default:()=>te(Tt)})},{label:"复制Token",key:"copy",icon:()=>te(ie,null,{default:()=>te(Nt)})}];return d.importMethod==="url"&&d.sourceUrl?i.unshift({label:"从URL刷新",key:"refresh-url",icon:()=>te(ie,null,{default:()=>te(Ct)})}):i.unshift({label:"刷新Token",key:"refresh",icon:()=>te(ie,null,{default:()=>te(Ne)})}),i.push({type:"divider"},{label:"删除",key:"delete",icon:()=>te(ie,null,{default:()=>te(St)})}),i},K=(d,i,m)=>{switch(d){case"edit":g();break;case"copy":r(m.token);break;case"refresh":q(i);break;case"refresh-url":T(i,m);break;case"delete":M(i);break}},S=()=>{o.initTokenManager(),t.success("Token数据已刷新")},O=()=>{n.warning({title:"清除用户Token",content:"确定要清除用户认证Token吗？这将会退出登录。",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{o.clearUserToken(),t.success("用户Token已清除")}})},U=(d,i)=>{if(p(d)==="connected")o.closeWebSocketConnection(d),t.info("WebSocket连接已断开");else try{o.createWebSocketConnection(d,i.token,i.wsUrl),t.success("正在建立WebSocket连接...")}catch{t.error("建立WebSocket连接失败")}},q=d=>{const i=o.getGameToken(d);if(!i){t.error("找不到对应的Token数据");return}if(!i.sourceUrl){t.warning("该Token没有配置源地址，无法重新生成。请手动重新导入Token。");return}n.info({title:"重新获取Token",content:"确定要从源地址重新获取此角色的Token吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{try{const m=t.loading("正在重新获取Token...",{duration:0});let w;const b=i.sourceUrl;if(b.startsWith(window.location.origin)||b.startsWith("/")||b.startsWith("http://localhost")||b.startsWith("http://127.0.0.1"))w=await fetch(b);else try{w=await fetch(b,{method:"GET",headers:{Accept:"application/json"},mode:"cors"})}catch(F){throw new Error(`跨域请求被阻止。请确保目标服务器支持CORS。错误详情: ${F.message}`)}if(!w.ok)throw new Error(`请求失败: ${w.status} ${w.statusText}`);const A=await w.json();if(!A.token)throw new Error("返回数据中未找到token字段");o.updateGameToken(d,{token:A.token,server:A.server||i.server,regeneratedAt:new Date().toISOString(),lastRefreshed:new Date().toISOString()}),o.getWebSocketStatus(d)==="connected"&&(o.closeWebSocketConnection(d),setTimeout(()=>{o.createWebSocketConnection(d,A.token,i.wsUrl)},500)),m.destroy(),t.success("Token已成功重新获取")}catch(m){console.error("重新获取Token失败:",m),t.error(m.message||"Token重新获取失败")}}})},M=d=>{n.warning({title:"删除Token",content:"确定要删除此角色的游戏Token吗？这将断开相关的WebSocket连接。",positiveText:"确定删除",negativeText:"取消",onPositiveClick:()=>{o.removeGameToken(d),t.success("Token已删除")}})},g=(d,i)=>{t.info("编辑功能正在开发中")},r=async d=>{try{await navigator.clipboard.writeText(d),t.success("Token已复制到剪贴板")}catch{const m=document.createElement("textarea");m.value=d,document.body.appendChild(m),m.select(),document.execCommand("copy"),document.body.removeChild(m),t.success("Token已复制到剪贴板")}},T=async(d,i)=>{if(!i.sourceUrl){t.warning("该Token没有配置源URL");return}n.info({title:"从URL刷新Token",content:`确定要从源URL重新获取Token吗？
源地址：${i.sourceUrl}`,positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{try{const m=t.loading("正在从URL获取新Token...",{duration:0});let w;if(i.sourceUrl.startsWith(window.location.origin)||i.sourceUrl.startsWith("/")||i.sourceUrl.startsWith("http://localhost")||i.sourceUrl.startsWith("http://127.0.0.1"))w=await fetch(i.sourceUrl);else{const A=`/api/proxy?url=${encodeURIComponent(i.sourceUrl)}`;w=await fetch(A)}if(!w.ok)throw new Error(`HTTP ${w.status}: ${w.statusText}`);const j=await w.json();if(!j.token)throw new Error("返回数据中未找到token字段");o.updateGameToken(d,{token:j.token,lastUsed:new Date().toISOString()}),m.destroy(),t.success("Token刷新成功")}catch(m){console.error("URL刷新Token失败:",m),t.error("刷新失败: "+m.message)}}})},_=()=>{try{const d=o.exportTokens(),i=JSON.stringify(d,null,2),m=new Blob([i],{type:"application/json"}),w=document.createElement("a");w.href=URL.createObjectURL(m),w.download=`tokens_backup_${new Date().toISOString().split("T")[0]}.json`,w.click(),t.success("Token数据已导出")}catch(d){t.error("导出失败: "+d.message)}},I=({file:d})=>{const i=new FileReader;i.onload=m=>{try{const w=JSON.parse(m.target.result),b=o.importTokens(w);b.success?(t.success(b.message),s.fetchGameRoles()):t.error(b.message)}catch{t.error("导入失败：文件格式错误")}},i.readAsText(d.file)},Z=()=>{n.info({title:"清理过期Token",content:"确定要清理超过24小时未使用的Token吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{const d=o.cleanExpiredTokens();t.success(`已清理 ${d} 个过期Token`)}})},N=()=>{n.error({title:"清除所有Token",content:"确定要清除所有游戏Token吗？这将断开所有WebSocket连接。此操作不可恢复！",positiveText:"确定清除",negativeText:"取消",onPositiveClick:()=>{o.clearAllGameTokens(),t.success("所有游戏Token已清除")}})};return(d,i)=>{const m=G("n-button"),w=G("n-upload"),b=G("n-dropdown"),j=G("n-tag"),A=rt;return x(),se(A,null,{extra:f(()=>[u("div",Oo,[h(m,{size:"small",onClick:S},{icon:f(()=>[h(ee(ie),null,{default:f(()=>[h(ee(Ne))]),_:1})]),default:f(()=>[i[0]||(i[0]=u("span",{class:"btn-text"},"刷新",-1))]),_:1}),h(m,{size:"small",type:"warning",onClick:_},{icon:f(()=>[...i[1]||(i[1]=[u("i",{class:"i-mdi:download"},null,-1)])]),default:f(()=>[i[2]||(i[2]=u("span",{class:"btn-text"},"导出",-1))]),_:1}),h(w,{"show-file-list":!1,accept:".json",onChange:I},{default:f(()=>[h(m,{size:"small",type:"info"},{icon:f(()=>[h(ee(ie),null,{default:f(()=>[h(ee(jt))]),_:1})]),default:f(()=>[i[3]||(i[3]=u("span",{class:"btn-text"},"导入",-1))]),_:1})]),_:1})])]),default:f(()=>[u("div",$o,[i[7]||(i[7]=u("h4",null,"用户认证Token",-1)),ee(o).userToken?(x(),Q("div",Eo,[u("div",Lo,[i[4]||(i[4]=u("span",{class:"token-label"},"Token:",-1)),u("span",Vo,H(l(ee(o).userToken)),1)]),h(m,{size:"tiny",type:"error",onClick:O},{default:f(()=>[...i[5]||(i[5]=[W(" 清除 ",-1)])]),_:1})])):(x(),Q("div",Mo,[...i[6]||(i[6]=[u("span",null,"未设置用户Token",-1)])]))]),u("div",xo,[u("h4",null,"游戏角色Token ("+H(Object.keys(ee(o).gameTokens).length)+"个)",1),u("div",Fo,[(x(!0),Q(tt,null,et(ee(vt),(F,P)=>(x(),Q("div",{key:P,class:"game-token-item"},[u("div",Po,[u("div",Wo,[u("span",qo,H(F.roleName),1),u("span",Ao,H(F.server),1)]),u("div",Uo,[h(m,{size:"tiny",type:p(P)==="connected"?"success":"default",onClick:Y=>U(P,F)},{default:f(()=>[W(H(p(P)==="connected"?"断开WS":"连接WS"),1)]),_:2},1032,["type","onClick"]),h(b,{options:z(F),trigger:"click",onSelect:Y=>K(Y,P,F)},{default:f(()=>[h(m,{size:"tiny",type:"tertiary"},{icon:f(()=>[h(ee(ie),null,{default:f(()=>[h(ee(wt))]),_:1})]),_:1})]),_:1},8,["options","onSelect"])])]),u("div",Ro,[u("div",zo,[i[8]||(i[8]=u("span",{class:"detail-label"},"Token:",-1)),u("span",Io,H(l(F.token)),1)]),u("div",No,[i[9]||(i[9]=u("span",{class:"detail-label"},"WebSocket URL:",-1)),u("span",Ho,H(F.wsUrl),1)]),u("div",Go,[i[10]||(i[10]=u("span",{class:"detail-label"},"创建时间:",-1)),u("span",Bo,H(c(F.createdAt)),1)]),u("div",Ko,[i[11]||(i[11]=u("span",{class:"detail-label"},"最后使用:",-1)),u("span",Zo,H(c(F.lastUsed)),1)]),u("div",Do,[i[12]||(i[12]=u("span",{class:"detail-label"},"连接状态:",-1)),h(j,{size:"small",type:$(p(P))},{default:f(()=>[W(H(E(p(P))),1)]),_:2},1032,["type"])])])]))),128))])])]),actions:f(()=>[h(m,{type:"warning",onClick:Z},{default:f(()=>[...i[13]||(i[13]=[W(" 清理过期Token ",-1)])]),_:1}),h(m,{type:"error",onClick:N},{default:f(()=>[...i[14]||(i[14]=[W(" 清除所有Token ",-1)])]),_:1})]),_:1})}}},Xo=st(Qo,[["__scopeId","data-v-1eeb8cd3"]]),Yo={class:"profile-page"},Jo={class:"container"},en={class:"security-items"},tn={class:"security-item"},on={class:"security-item"},nn={class:"security-item"},sn={class:"security-item danger"},rn={__name:"Profile",setup(e){bt();const t=ot(),n=nt(),o=_t(),s=we(null),l=ne({username:"",email:"",nickname:"",phone:"",avatar:""}),c=ne({currentPassword:"",newPassword:"",confirmPassword:""}),p=ne({theme:"auto",language:"zh-CN",notifications:!0,autoExecute:!1}),$=[{label:"跟随系统",value:"auto"},{label:"浅色主题",value:"light"},{label:"深色主题",value:"dark"}],E=[{label:"简体中文",value:"zh-CN"},{label:"English",value:"en-US"}],z=async()=>{try{t.success("个人信息保存成功")}catch{t.error("保存失败，请稍后重试")}},K=async()=>{if(s.value)try{await s.value.validate(),t.success("密码修改成功"),Object.keys(c).forEach(g=>{c[g]=""})}catch{}},S=g=>{p.theme=g,localStorage.setItem("theme",g),g==="dark"?document.documentElement.setAttribute("data-theme","dark"):g==="light"?document.documentElement.removeAttribute("data-theme"):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.removeAttribute("data-theme")},O=()=>{t.info("两步验证设置功能开发中...")},U=()=>{t.info("登录历史查看功能开发中...")},q=()=>{t.info("数据导出功能开发中...")},M=()=>{n.warning({title:"删除账户",content:"此操作将永久删除您的账户和所有数据，且无法恢复。确定要继续吗？",positiveText:"确定删除",negativeText:"取消",onPositiveClick:()=>{t.error("账户删除功能暂未开放")}})};return xe(()=>{o.userInfo&&Object.assign(l,o.userInfo);const g=localStorage.getItem("userPreferences");if(g)try{Object.assign(p,JSON.parse(g))}catch(r){console.error("解析用户偏好失败:",r)}}),(g,r)=>{const T=At,_=ye,I=_o,Z=Ft,N=rt,d=G("n-select"),i=G("n-switch"),m=Xo,w=G("n-button");return x(),Q("div",Yo,[u("div",Jo,[r[25]||(r[25]=u("div",{class:"page-header"},[u("h1",null,"个人资料"),u("p",null,"管理您的账户信息和偏好设置")],-1)),r[26]||(r[26]=u("h2",null,"基本信息",-1)),h(N,null,{actions:f(()=>[h(Z,{type:"primary",onClick:z},{default:f(()=>[...r[11]||(r[11]=[W(" 保存更改 ",-1)])]),_:1})]),default:f(()=>[h(I,{model:l,"label-placement":"left","label-width":"80px"},{default:f(()=>[h(_,{label:"用户名"},{default:f(()=>[h(T,{value:l.username,"onUpdate:value":r[0]||(r[0]=b=>l.username=b),readonly:""},null,8,["value"])]),_:1}),h(_,{label:"邮箱"},{default:f(()=>[h(T,{value:l.email,"onUpdate:value":r[1]||(r[1]=b=>l.email=b)},null,8,["value"])]),_:1}),h(_,{label:"昵称"},{default:f(()=>[h(T,{value:l.nickname,"onUpdate:value":r[2]||(r[2]=b=>l.nickname=b),placeholder:"请输入昵称"},null,8,["value"])]),_:1}),h(_,{label:"手机"},{default:f(()=>[h(T,{value:l.phone,"onUpdate:value":r[3]||(r[3]=b=>l.phone=b),placeholder:"请输入手机号"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),r[27]||(r[27]=u("h2",null,"密码修改",-1)),h(N,null,{actions:f(()=>[h(Z,{type:"primary",onClick:K},{default:f(()=>[...r[12]||(r[12]=[W(" 修改密码 ",-1)])]),_:1})]),default:f(()=>[h(I,{model:c,ref_key:"passwordFormRef",ref:s,"label-placement":"left","label-width":"100px"},{default:f(()=>[h(_,{label:"当前密码",prop:"currentPassword"},{default:f(()=>[h(T,{value:c.currentPassword,"onUpdate:value":r[4]||(r[4]=b=>c.currentPassword=b),type:"password",placeholder:"请输入当前密码"},null,8,["value"])]),_:1}),h(_,{label:"新密码",prop:"newPassword"},{default:f(()=>[h(T,{value:c.newPassword,"onUpdate:value":r[5]||(r[5]=b=>c.newPassword=b),type:"password",placeholder:"请输入新密码"},null,8,["value"])]),_:1}),h(_,{label:"确认新密码",prop:"confirmPassword"},{default:f(()=>[h(T,{value:c.confirmPassword,"onUpdate:value":r[6]||(r[6]=b=>c.confirmPassword=b),type:"password",placeholder:"请再次输入新密码"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),r[28]||(r[28]=u("h2",null,"系统偏好",-1)),h(N,null,{default:f(()=>[h(I,null,{default:f(()=>[h(_,{label:"主题设置"},{extra:f(()=>[...r[13]||(r[13]=[W(" 选择您喜欢的界面主题 ",-1)])]),default:f(()=>[h(d,{value:p.theme,"onUpdate:value":[r[7]||(r[7]=b=>p.theme=b),S],options:$},null,8,["value"])]),_:1}),h(_,{label:"语言设置"},{extra:f(()=>[...r[14]||(r[14]=[W(" 选择界面显示语言 ",-1)])]),default:f(()=>[h(d,{value:p.language,"onUpdate:value":r[8]||(r[8]=b=>p.language=b),options:E},null,8,["value"])]),_:1}),h(_,{label:"通知设置"},{extra:f(()=>[...r[15]||(r[15]=[W(" 接收任务完成通知 ",-1)])]),default:f(()=>[h(i,{value:p.notifications,"onUpdate:value":r[9]||(r[9]=b=>p.notifications=b)},null,8,["value"])]),_:1}),h(_,{label:"自动执行"},{extra:f(()=>[...r[16]||(r[16]=[W(" 默认开启任务自动执行 ",-1)])]),default:f(()=>[h(i,{value:p.autoExecute,"onUpdate:value":r[10]||(r[10]=b=>p.autoExecute=b)},null,8,["value"])]),_:1})]),_:1})]),_:1}),r[29]||(r[29]=u("h2",null,"Token管理",-1)),h(m),r[30]||(r[30]=u("h2",null,"账户安全",-1)),h(N,null,{default:f(()=>[u("div",en,[u("div",tn,[r[18]||(r[18]=u("div",{class:"security-info"},[u("h3",null,"两步验证"),u("p",null,"为您的账户添加额外的安全保护")],-1)),h(w,{onClick:O},{default:f(()=>[...r[17]||(r[17]=[W(" 设置 ",-1)])]),_:1})]),u("div",on,[r[20]||(r[20]=u("div",{class:"security-info"},[u("h3",null,"登录历史"),u("p",null,"查看最近的登录记录")],-1)),h(w,{onClick:U},{default:f(()=>[...r[19]||(r[19]=[W(" 查看 ",-1)])]),_:1})]),u("div",nn,[r[22]||(r[22]=u("div",{class:"security-info"},[u("h3",null,"数据导出"),u("p",null,"导出您的所有数据")],-1)),h(w,{onClick:q},{default:f(()=>[...r[21]||(r[21]=[W(" 导出 ",-1)])]),_:1})]),u("div",sn,[r[24]||(r[24]=u("div",{class:"security-info"},[u("h3",null,"删除账户"),u("p",null,"永久删除您的账户和所有数据")],-1)),h(w,{type:"error",onClick:M},{default:f(()=>[...r[23]||(r[23]=[W(" 删除 ",-1)])]),_:1})])])]),_:1})])])}}},yn=st(rn,[["__scopeId","data-v-c46765b7"]]);export{yn as default};
