import{T as De,H as Q}from"./ThemeToggle-CJMmxcww.js";import{k as ae,c as W,i as T,a as c,l as Ve,n as Y,b as n,C as Ge,F as oe,p as He,q as qe,s as Je,r as x,v as Xe,x as Ye,o as Ze,y as R,e as N,w as s,u,d as U,g as ve,z as ge,A as ee,f as Ke,j as g,N as w,t as A,B as G,D as O}from"./index-COVLnS54.js";import{_ as Qe}from"./xiaoyugan-CodOW0Y3.js";import et from"./manual-DfWQ5TO9.js";import tt from"./url-DrPEm0lI.js";import{E as nt,B as st,T as ot}from"./bin-DEops62P.js";import{_ as at}from"./plugin-vue_export-helper-DlAUqK2U.js";import{M as lt,C as rt}from"./index-CAG2V5Zb.js";import{C as it,S as ut,T as ct,a as dt}from"./index-CvQEcn6R.js";import{A as ke}from"./Add-DcXBZFXt.js";import{M as mt}from"./Menu-dc4IvKan.js";import{g as _e,s as we,a as be,b as pt,i as Te,c as ft,B as vt}from"./index-7UPYbMBc.js";import{R as te}from"./Refresh-CmOv21kq.js";import{E as ye}from"./EllipsisHorizontal--qpl2Dhe.js";import"./AlertCircleOutline-DnI7bZ5a.js";import"./CloudUpload-CICfphmf.js";import"./index-FYmtpfEv.js";import"./render-function-DC6qNXon.js";const gt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},kt=c("path",{d:"M394 480a16 16 0 0 1-9.39-3L256 383.76L127.39 477a16 16 0 0 1-24.55-18.08L153 310.35L23 221.2a16 16 0 0 1 9-29.2h160.38l48.4-148.95a16 16 0 0 1 30.44 0l48.4 149H480a16 16 0 0 1 9.05 29.2L359 310.35l50.13 148.53A16 16 0 0 1 394 480z",fill:"currentColor"},null,-1),Tt=[kt],yt=ae({name:"Star",render:function(l,m){return T(),W("svg",gt,Tt)}}),_t=["red","orangered","orange","gold","lime","green","cyan","arcoblue","purple","pinkpurple","magenta","gray"],wt=["normal","processing","success","warning","danger"];var ne=ae({name:"Badge",props:{text:{type:String},dot:{type:Boolean},dotStyle:{type:Object},maxCount:{type:Number,default:99},offset:{type:Array,default:()=>[]},color:{type:String},status:{type:String,validator:i=>wt.includes(i)},count:{type:Number}},setup(i,{slots:l}){const{status:m,color:a,dotStyle:M,offset:r,text:k,dot:y,maxCount:_,count:b}=Ve(i),f=_e("badge"),C=bt(f,m==null?void 0:m.value,l==null?void 0:l.default),P=Y(()=>{const S={...(M==null?void 0:M.value)||{}},[p,L]=(r==null?void 0:r.value)||[];p&&(S.marginRight=`${-p}px`),L&&(S.marginTop=`${L}px`);const D=!(a!=null&&a.value)||_t.includes(a==null?void 0:a.value)?{}:{backgroundColor:a.value};return{mergedStyle:{...D,...S},computedDotStyle:S,computedColorStyle:D}}),F=()=>{const S=k==null?void 0:k.value,p=a==null?void 0:a.value,L=m==null?void 0:m.value,D=y==null?void 0:y.value,j=Number(b==null?void 0:b.value),I=(b==null?void 0:b.value)!=null,{computedDotStyle:H,mergedStyle:V}=P.value;return l.content?n("span",{class:`${f}-custom-dot`,style:H},[l.content()]):S&&!p&&!L?n("span",{class:`${f}-text`,style:H},[S]):L||p&&!I?n("span",{class:`${f}-status-wrapper`},[n("span",{class:[`${f}-status-dot`,{[`${f}-status-${L}`]:L,[`${f}-color-${p}`]:p}],style:V},null),S&&n("span",{class:`${f}-status-text`},[S])]):(D||p)&&j>0?n("span",{class:[`${f}-dot`,{[`${f}-color-${p}`]:p}],style:V},null):j===0?null:n("span",{class:`${f}-number`,style:V},[n("span",null,[_.value&&j>_.value?`${_.value}+`:j])])};return()=>n("span",{class:C.value},[l.default&&l.default(),F()])}});const bt=(i,l,m)=>Y(()=>[i,{[`${i}-status`]:l,[`${i}-no-children`]:!m}]),ht=Object.assign(ne,{install:(i,l)=>{we(i,l);const m=be(l);i.component(m+ne.name,ne)}});var se=ae({name:"Space",props:{align:{type:String},direction:{type:String,default:"horizontal"},size:{type:[Number,String,Array],default:"small"},wrap:{type:Boolean},fill:{type:Boolean}},setup(i,{slots:l}){const m=_e("space"),a=Y(()=>{var y;return(y=i.align)!=null?y:i.direction==="horizontal"?"center":""}),M=Y(()=>[m,{[`${m}-${i.direction}`]:i.direction,[`${m}-align-${a.value}`]:a.value,[`${m}-wrap`]:i.wrap,[`${m}-fill`]:i.fill}]);function r(y){if(ft(y))return y;switch(y){case"mini":return 4;case"small":return 8;case"medium":return 16;case"large":return 24;default:return 8}}const k=y=>{const _={},b=`${r(Te(i.size)?i.size[0]:i.size)}px`,f=`${r(Te(i.size)?i.size[1]:i.size)}px`;return y?i.wrap?{marginBottom:f}:{}:(i.direction==="horizontal"&&(_.marginRight=b),(i.direction==="vertical"||i.wrap)&&(_.marginBottom=f),_)};return()=>{var y;const _=pt((y=l.default)==null?void 0:y.call(l),!0).filter(b=>b.type!==Ge);return n("div",{class:M.value},[_.map((b,f)=>{var C,P;const F=l.split&&f>0;return n(oe,{key:(C=b.key)!=null?C:`item-${f}`},[F&&n("div",{class:`${m}-item-split`,style:k(!1)},[(P=l.split)==null?void 0:P.call(l)]),n("div",{class:`${m}-item`,style:k(f===_.length-1)},[b])])})])}}});const St=Object.assign(se,{install:(i,l)=>{we(i,l);const m=be(l);i.component(m+se.name,se)}}),$t={class:"token-import-page"},Ct={class:"container"},xt={class:"page-header"},Ut={class:"header-content"},At={class:"header-top"},Mt={class:"card-header"},Bt={class:"card-body"},zt={key:0,class:"tokens-section"},Et={class:"section-header"},Rt={class:"header-actions"},Nt={key:0,class:"tokens-grid"},Ot={class:"token-display"},Pt={class:"token-value"},Lt={class:"token-timestamps"},Ft={class:"timestamp-item"},Wt={class:"timestamp-value"},jt={class:"timestamp-item"},It={class:"timestamp-value"},Dt={class:"storage-info"},Vt={class:"storage-item"},Gt={key:0,class:"storage-upgrade"},Ht={key:1,class:"tokens-list"},qt={style:{"min-width":"120px"}},Jt={style:{"font-weight":"bold","font-size":"1.1em","margin-right":"8px"}},Xt={style:{"min-width":"100px"}},Yt={class:"modal-actions"},Zt={__name:"index",props:{token:String,name:String,server:String,wsUrl:String,api:String,auto:Boolean},setup(i){const l=i,m=Ke(),a=He(),M=qe(),r=Je(),k=x(!1),y=x(!1),_=x(!1);x(null),x(null);const b=x(null),f=x(null),C=x("manual"),P=x(new Set),F=x(new Set),S=x("card"),p=Xe({name:"",token:"",server:"",wsUrl:""}),L={name:[{required:!0,message:"请输入Token名称",trigger:"blur"}],token:[{required:!0,message:"请输入Token字符串",trigger:"blur"}]},D=[{label:"刷新所有Token",key:"refreshAll"},{label:"导出所有Token",key:"export"},{label:"导入Token文件",key:"import"},{label:"清理过期Token",key:"clean"},{label:"断开所有连接",key:"disconnect"},{label:"清除所有Token",key:"clear"}],j=()=>{k.value=!0},I=async t=>{P.value.add(t.id);try{if(t.sourceUrl){let e;if(t.sourceUrl.startsWith(window.location.origin)||t.sourceUrl.startsWith("/")||t.sourceUrl.startsWith("http://localhost")||t.sourceUrl.startsWith("http://127.0.0.1"))e=await fetch(t.sourceUrl);else try{e=await fetch(t.sourceUrl,{method:"GET",headers:{Accept:"application/json"},mode:"cors"})}catch(B){throw new Error(`跨域请求被阻止。请确保目标服务器支持CORS。错误详情: ${B.message}`)}if(!e.ok)throw new Error(`请求失败: ${e.status} ${e.statusText}`);const v=await e.json();if(!v.token)throw new Error("返回数据中未找到token字段");r.updateToken(t.id,{token:v.token,server:v.server||t.server,lastRefreshed:Date.now()}),a.success("Token刷新成功")}else{M.info({title:"重新获取Token",content:`Token "${t.name}" 是手动导入的，没有配置自动刷新地址。

请选择以下操作：
1. 重新手动导入新的Token
2. 尝试重新连接现有Token`,positiveText:"重新导入",negativeText:"重新连接",onPositiveClick:()=>{k.value=!0,C.value="manual",importForm.name=t.name,importForm.server=t.server,importForm.wsUrl=t.wsUrl},onNegativeClick:()=>{r.getWebSocketStatus(t.id)==="connected"&&r.closeWebSocketConnection(t.id),setTimeout(()=>{r.createWebSocketConnection(t.id,t.token,t.wsUrl),a.info("正在尝试重新连接...")},500)}});return}r.getWebSocketStatus(t.id)==="connected"&&(r.closeWebSocketConnection(t.id),setTimeout(()=>{r.createWebSocketConnection(t.id,t.token,t.wsUrl)},500))}catch(e){console.error("刷新Token失败:",e),a.error(e.message||"Token刷新失败")}finally{P.value.delete(t.id)}},H=t=>{M.warning({title:"升级为长期有效",content:`确认要将Token "${t.name}" 升级为长期有效吗？升级后该Token将不会因24小时未使用而被自动清理。`,positiveText:"确认升级",negativeText:"取消",onPositiveClick:()=>{r.upgradeTokenToPermanent(t.id)?a.success(`Token "${t.name}" 已升级为长期有效！`):a.error("升级失败，该Token可能已经是长期有效状态")}})},V=(t,e=!1)=>{const d=ee.value===t.id,v=q(t.id);if(d&&v==="connected"&&!e){a.info(`${t.name} 已选中且已连接`);return}if(d&&v==="connecting"&&!e){a.info(`${t.name} 正在连接中...`);return}r.selectToken(t.id,e)?e?a.success(`强制重连：${t.name}`):d?a.success(`重新连接：${t.name}`):a.success(`已选择：${t.name}`):a.error(`选择Token失败：${t.name}`)},q=t=>r.getWebSocketStatus(t),le=t=>{const e=q(t);return{connected:"已连接",connecting:"连接中...",disconnected:"已断开",error:"连接错误",disconnecting:"断开中..."}[e]||"未连接"},re=t=>{const e=q(t);return{connected:"success",connecting:"processing",disconnected:"normal",error:"danger",disconnecting:"warning"}[e]||"normal"},ie=t=>{const e=[{label:"编辑",key:"edit",icon:()=>O(w,null,{default:()=>O(dt)})},{label:"复制Token",key:"copy",icon:()=>O(w,null,{default:()=>O(rt)})}];return t.importMethod==="url"&&t.sourceUrl?e.push({label:"从URL刷新",key:"refresh-url",icon:()=>O(w,null,{default:()=>O(ut)})}):e.push({label:"重新获取",key:"refresh",icon:()=>O(w,null,{default:()=>O(te)})}),e.push({type:"divider"},{label:"删除",key:"delete",icon:()=>O(w,null,{default:()=>O(ct)}),props:{style:{color:"#e74c3c"}}}),e},ue=async(t,e)=>{switch(t){case"edit":he(e);break;case"copy":$e(e);break;case"refresh":I(e);break;case"refresh-url":I(e);break;case"delete":Ce(e);break}},he=t=>{f.value=t,Object.assign(p,{name:t.name,token:t.token,server:t.server||"",wsUrl:t.wsUrl||""}),_.value=!0},Se=async()=>{if(!(!b.value||!f.value))try{await b.value.validate(),r.updateToken(f.value.id,{name:p.name,token:p.token,server:p.server,wsUrl:p.wsUrl}),a.success("Token信息已更新"),_.value=!1,f.value=null}catch{}},$e=async t=>{try{await navigator.clipboard.writeText(t.token),a.success("Token已复制到剪贴板")}catch{a.error("复制失败")}},Ce=t=>{M.warning({title:"删除Token",content:`确定要删除Token "${t.name}" 吗？此操作无法恢复。`,positiveText:"确定删除",negativeText:"取消",onPositiveClick:()=>{r.removeToken(t.id),a.success("Token已删除")}})},xe=async()=>{if(!r.gameTokens.length){a.warning("没有可刷新的Token");return}const t=r.gameTokens.filter(d=>d.sourceUrl),e=r.gameTokens.filter(d=>!d.sourceUrl);if(t.length===0){a.warning("没有支持自动刷新的Token");return}M.warning({title:"批量刷新Token",content:"确定要刷新所有支持自动刷新的Token吗?",positiveText:"开始刷新",negativeText:"取消",onPositiveClick:async()=>{try{let d=0,v=0;const B=a.loading(`正在批量刷新Token (0/${t.length})`,{duration:0});for(let z=0;z<t.length;z++){const $=t[z];try{B.content=`正在刷新Token (${z+1}/${t.length}): ${$.name}`,await I($),d++}catch(h){console.error(`刷新Token "${$.name}" 失败:`,h),v++}z<t.length-1&&await new Promise(h=>setTimeout(h,500))}B.destroy(),v===0?a.success(`批量刷新完成！成功刷新 ${d} 个Token`):a.warning(`批量刷新完成，成功 ${d} 个，失败 ${v} 个`),e.length>0&&a.info(`${e.length} 个手动导入的Token需要手动刷新`)}catch(d){a.error("批量刷新过程中发生错误: "+d.message)}}})},Ue=t=>{switch(t){case"refreshAll":xe();break;case"export":Ae();break;case"import":Me();break;case"clean":Be();break;case"disconnect":ze();break;case"clear":Ee();break}},Ae=()=>{try{const t=r.exportTokens(),e=JSON.stringify(t,null,2),d=new Blob([e],{type:"application/json"}),v=document.createElement("a");v.href=URL.createObjectURL(d),v.download=`tokens_backup_${new Date().toISOString().split("T")[0]}.json`,v.click(),a.success("Token数据已导出")}catch{a.error("导出失败")}},Me=()=>{const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=e=>{const d=e.target.files[0];if(d){const v=new FileReader;v.onload=B=>{try{const z=JSON.parse(B.target.result),$=r.importTokens(z);$.success?a.success($.message):a.error($.message)}catch{a.error("文件格式错误")}},v.readAsText(d)}},t.click()},Be=()=>{const t=r.cleanExpiredTokens();a.success(`已清理 ${t} 个过期Token`)},ze=()=>{r.gameTokens.forEach(t=>{r.closeWebSocketConnection(t.id)}),a.success("所有连接已断开")},Ee=()=>{M.error({title:"清除所有Token",content:"确定要清除所有Token吗？此操作无法恢复！",positiveText:"确定清除",negativeText:"取消",onPositiveClick:()=>{r.clearAllTokens(),a.success("所有Token已清除")}})},Re=t=>{if(!t)return"";const e=t.length;return e<=8?t:t.substring(0,4)+"***"+t.substring(e-4)},ce=t=>new Date(t).toLocaleString("zh-CN"),Ne=()=>{m.push("/admin/dashboard")},de=async t=>{F.value.add(t.id);try{if(r.selectToken(t.id),q(t.id)==="connected"){a.success(`${t.name} 已连接，进入任务管理`),m.push("/admin/dashboard");return}}finally{F.value.delete(t.id)}},me=async()=>{if(l.token||l.api)try{y.value=!0;let t=null;if(l.api){a.info("正在从API获取token...");const e=await fetch(l.api,{method:"GET",headers:{Accept:"application/json"},mode:"cors"});if(!e.ok)throw new Error(`API请求失败: ${e.status} ${e.statusText}`);const d=await e.json();if(!d.token)throw new Error("API返回数据中未找到token字段");t=r.importBase64Token(l.name||d.name||"通过API导入的Token",d.token,{server:l.server||d.server,wsUrl:l.wsUrl,sourceUrl:l.api,importMethod:"url"})}else l.token&&(a.info("正在导入token..."),t=r.importBase64Token(l.name||"通过URL导入的Token",l.token,{server:l.server,wsUrl:l.wsUrl,importMethod:"url"}));if(t&&t.success)a.success(`Token "${t.tokenName}" 导入成功！`),l.auto&&t.token?(r.selectToken(t.token.id),a.success("正在跳转到控制台..."),setTimeout(()=>{m.push("/admin/dashboard")},1500)):m.replace("/tokens");else throw new Error((t==null?void 0:t.message)||"Token导入失败")}catch(t){console.error("URL参数处理失败:",t),a.error(`导入失败: ${t.message}`),m.replace("/tokens")}finally{y.value=!1}};return Ye(()=>[l.token,l.api],me,{immediate:!1}),Ze(async()=>{r.initTokenStore(),await me(),!r.hasTokens&&!l.token&&!l.api&&(k.value=!0)}),(t,e)=>{const d=De,v=U("n-radio-button"),B=U("n-radio-group"),z=lt,$=U("n-space"),h=U("n-button"),Z=U("n-dropdown"),Oe=ot,pe=ht,Pe=St,fe=vt,K=U("n-tag"),Le=it,Fe=U("n-card"),We=nt,J=U("n-input"),X=U("n-form-item"),je=U("n-form"),Ie=U("n-modal");return T(),W("div",$t,[c("div",Ct,[c("div",xt,[c("div",Ut,[c("div",At,[e[17]||(e[17]=c("img",{src:Qe,alt:"XYZW",class:"brand-logo"},null,-1)),n(d)]),e[18]||(e[18]=c("h1",null,"游戏Token管理",-1))])]),n(z,{visible:k.value,"onUpdate:visible":e[7]||(e[7]=o=>k.value=o),width:"40rem",footer:!1,"default-visible":!u(r).hasTokens},{title:s(()=>[c("h2",null,[n(u(w),null,{default:s(()=>[n(u(ke))]),_:1}),e[19]||(e[19]=g(" 添加游戏Token ",-1))])]),default:s(()=>[c("div",Mt,[n(B,{value:C.value,"onUpdate:value":e[0]||(e[0]=o=>C.value=o),class:"import-method-tabs",size:"small"},{default:s(()=>[n(v,{value:"manual"},{default:s(()=>[...e[20]||(e[20]=[g(" 手动输入 ",-1)])]),_:1}),n(v,{value:"url"},{default:s(()=>[...e[21]||(e[21]=[g(" URL获取 ",-1)])]),_:1}),n(v,{value:"bin"},{default:s(()=>[...e[22]||(e[22]=[g(" BIN获取 ",-1)])]),_:1})]),_:1},8,["value"])]),c("div",Bt,[C.value==="manual"?(T(),N(et,{key:0,onCancel:e[1]||(e[1]=()=>k.value=!1),onOk:e[2]||(e[2]=()=>k.value=!1)})):R("",!0),C.value==="url"?(T(),N(tt,{key:1,onCancel:e[3]||(e[3]=()=>k.value=!1),onOk:e[4]||(e[4]=()=>k.value=!1)})):R("",!0),C.value==="bin"?(T(),N(st,{key:2,onCancel:e[5]||(e[5]=()=>k.value=!1),onOk:e[6]||(e[6]=()=>k.value=!1)})):R("",!0)])]),_:1},8,["visible","default-visible"]),u(r).hasTokens?(T(),W("div",zt,[c("div",Et,[n($,{align:"center"},{default:s(()=>[c("h2",null,"我的Token列表 ("+A(u(r).gameTokens.length)+"个)",1),n(B,{value:S.value,"onUpdate:value":e[8]||(e[8]=o=>S.value=o),size:"small"},{default:s(()=>[n(v,{value:"card"},{default:s(()=>[...e[23]||(e[23]=[g("卡片",-1)])]),_:1}),n(v,{value:"list"},{default:s(()=>[...e[24]||(e[24]=[g("列表",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),c("div",Rt,[u(r).selectedToken?(T(),N(h,{key:0,type:"success",onClick:Ne},{icon:s(()=>[n(u(w),null,{default:s(()=>[n(u(Q))]),_:1})]),default:s(()=>[e[25]||(e[25]=g(" 返回控制台 ",-1))]),_:1})):R("",!0),k.value?R("",!0):(T(),N(h,{key:1,type:"primary",onClick:e[9]||(e[9]=o=>k.value=!0)},{icon:s(()=>[n(u(w),null,{default:s(()=>[n(u(ke))]),_:1})]),default:s(()=>[e[26]||(e[26]=g(" 添加Token ",-1))]),_:1})),n(Z,{options:D,onSelect:Ue},{default:s(()=>[n(h,null,{icon:s(()=>[n(u(w),null,{default:s(()=>[n(u(mt))]),_:1})]),default:s(()=>[e[27]||(e[27]=g(" 批量操作 ",-1))]),_:1})]),_:1})])]),S.value==="card"?(T(),W("div",Nt,[(T(!0),W(oe,null,ve(u(r).gameTokens,o=>(T(),N(Le,{key:o.id,class:ge({"token-card":!0,active:u(ee)===o.id}),onClick:E=>V(o)},{title:s(()=>[n(Pe,{class:"token-name"},{default:s(()=>[g(A(o.name)+" ",1),o.server?(T(),N(Oe,{key:0,color:"red"},{default:s(()=>[g(A(o.server),1)]),_:2},1024)):R("",!0),n(pe,{status:re(o.id),text:le(o.id)},null,8,["status","text"])]),_:2},1024)]),extra:s(()=>[n(Z,{options:ie(o),onSelect:E=>ue(E,o)},{default:s(()=>[n(h,{text:""},{icon:s(()=>[n(u(w),null,{default:s(()=>[n(u(ye))]),_:1})]),_:1})]),_:1},8,["options","onSelect"])]),default:s(()=>[c("div",Ot,[e[28]||(e[28]=c("span",{class:"token-label"},"Token:",-1)),c("code",Pt,A(Re(o.token)),1)]),n(fe,{loading:P.value.has(o.id),onClick:G(E=>I(o),["stop"])},{icon:s(()=>[n(u(w),null,{default:s(()=>[n(u(te))]),_:1})]),default:s(()=>[g(" "+A(o.sourceUrl?"刷新":"重新获取"),1)]),_:2},1032,["loading","onClick"]),c("div",Lt,[c("div",Ft,[e[29]||(e[29]=c("span",{class:"timestamp-label"},"创建：",-1)),c("span",Wt,A(ce(o.createdAt)),1)]),c("div",jt,[e[30]||(e[30]=c("span",{class:"timestamp-label"},"使用：",-1)),c("span",It,A(ce(o.lastUsed)),1)])]),c("div",Dt,[c("div",Vt,[e[31]||(e[31]=c("span",{class:"storage-label"},"存储类型：",-1)),n(K,{size:"small",type:o.importMethod==="url"?"success":"warning"},{default:s(()=>[g(A(o.importMethod==="url"?"长期有效":"临时存储"),1)]),_:2},1032,["type"])]),o.importMethod!=="url"?(T(),W("div",Gt,[n(h,{size:"tiny",type:"success",ghost:"",onClick:G(E=>H(o),["stop"])},{icon:s(()=>[n(u(w),null,{default:s(()=>[n(u(yt))]),_:1})]),default:s(()=>[e[32]||(e[32]=g(" 升级为长期有效 ",-1))]),_:1},8,["onClick"])])):R("",!0)])]),actions:s(()=>[n(h,{type:"primary",size:"large",block:"",loading:F.value.has(o.id),onClick:E=>de(o)},{icon:s(()=>[n(u(w),null,{default:s(()=>[n(u(Q))]),_:1})]),default:s(()=>[e[33]||(e[33]=g(" 开始任务管理 ",-1))]),_:1},8,["loading","onClick"])]),_:2},1032,["class","onClick"]))),128))])):(T(),W("div",Ht,[(T(!0),W(oe,null,ve(u(r).gameTokens,o=>(T(),N(Fe,{key:o.id,size:"small",style:{"margin-bottom":"8px"},hoverable:"",onClick:E=>V(o),class:ge({active:u(ee)===o.id})},{default:s(()=>[n($,{justify:"space-between",align:"center"},{default:s(()=>[n($,{align:"center",size:24},{default:s(()=>[c("div",qt,[c("span",Jt,A(o.name),1),o.server?(T(),N(K,{key:0,size:"small",type:"error"},{default:s(()=>[g(A(o.server),1)]),_:2},1024)):R("",!0)]),c("div",Xt,[n(pe,{status:re(o.id),text:le(o.id)},null,8,["status","text"])]),n(K,{size:"small",type:o.importMethod==="url"?"success":"warning"},{default:s(()=>[g(A(o.importMethod==="url"?"长期":"临时"),1)]),_:2},1032,["type"])]),_:2},1024),n($,null,{default:s(()=>[n(h,{size:"small",type:"primary",loading:F.value.has(o.id),onClick:G(E=>de(o),["stop"])},{icon:s(()=>[n(u(w),null,{default:s(()=>[n(u(Q))]),_:1})]),default:s(()=>[e[34]||(e[34]=g(" 管理 ",-1))]),_:1},8,["loading","onClick"]),n(h,{size:"small",onClick:G(E=>I(o),["stop"]),loading:P.value.has(o.id)},{icon:s(()=>[n(u(w),null,{default:s(()=>[n(u(te))]),_:1})]),default:s(()=>[e[35]||(e[35]=g(" 刷新 ",-1))]),_:1},8,["onClick","loading"]),n(Z,{options:ie(o),onSelect:E=>ue(E,o)},{default:s(()=>[n(h,{size:"small",circle:"",onClick:e[10]||(e[10]=G(()=>{},["stop"]))},{icon:s(()=>[n(u(w),null,{default:s(()=>[n(u(ye))]),_:1})]),_:1})]),_:1},8,["options","onSelect"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]))])):R("",!0),!u(r).hasTokens&&!k.value?(T(),N(We,{key:1},{image:s(()=>[...e[36]||(e[36]=[c("i",{class:"mdi:bed-empty"},null,-1)])]),default:s(()=>[e[38]||(e[38]=g(" 还没有导入任何Token ",-1)),n(fe,{type:"link",onClick:j},{default:s(()=>[...e[37]||(e[37]=[g("打开Token管理",-1)])]),_:1})]),_:1})):R("",!0)]),n(Ie,{show:_.value,"onUpdate:show":e[16]||(e[16]=o=>_.value=o),preset:"card",title:"编辑Token",style:{width:"500px"}},{footer:s(()=>[c("div",Yt,[n(h,{onClick:e[15]||(e[15]=o=>_.value=!1)},{default:s(()=>[...e[39]||(e[39]=[g(" 取消 ",-1)])]),_:1}),n(h,{type:"primary",onClick:Se},{default:s(()=>[...e[40]||(e[40]=[g(" 保存 ",-1)])]),_:1})])]),default:s(()=>[n(je,{ref_key:"editFormRef",ref:b,model:p,rules:L,"label-placement":"left","label-width":"80px"},{default:s(()=>[n(X,{label:"名称",path:"name"},{default:s(()=>[n(J,{value:p.name,"onUpdate:value":e[11]||(e[11]=o=>p.name=o)},null,8,["value"])]),_:1}),n(X,{label:"Token字符串",path:"token"},{default:s(()=>[n(J,{value:p.token,"onUpdate:value":e[12]||(e[12]=o=>p.token=o),type:"textarea",rows:3,placeholder:"粘贴Token字符串...",clearable:""},null,8,["value"])]),_:1}),n(X,{label:"服务器"},{default:s(()=>[n(J,{value:p.server,"onUpdate:value":e[13]||(e[13]=o=>p.server=o)},null,8,["value"])]),_:1}),n(X,{label:"WebSocket地址"},{default:s(()=>[n(J,{value:p.wsUrl,"onUpdate:value":e[14]||(e[14]=o=>p.wsUrl=o)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])])}}},kn=at(Zt,[["__scopeId","data-v-c80019d0"]]);export{kn as default};
